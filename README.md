# Plate Recognition

Приложение для обнаружения и распознавания автомобильных номеров на видеопотоке с помощью Ultralytics YOLO и EasyOCR. Графический интерфейс построен на PyQt5 и позволяет подключать несколько источников видео, сохранять настройки и отслеживать распознанные номера в режиме реального времени.

## Возможности
- Детекция номерных знаков с помощью дообученной модели YOLO (`models/best.pt`).
- Распознавание символов через EasyOCR с фильтрацией по регулярным выражениям из `configs/plate_patterns.yaml`.
- GUI с просмотром видео, списком событий и настройками частоты отправки кадров и путей к видеопотокам.
- Сохранение настроек в `config.yaml` без необходимости перезапуска приложения.

## Требования
- Python 3.10+
- PyQt5
- Ultralytics (YOLO)
- OpenCV (`opencv-python`)
- EasyOCR
- PyTorch (CPU или GPU)

## Установка
1. Создайте и активируйте виртуальное окружение.
2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
   Если файл `requirements.txt` отсутствует, установите основные пакеты вручную:
   ```bash
   pip install pyqt5 ultralytics opencv-python easyocr torch pyyaml
   ```
3. Поместите веса модели в `models/best.pt` (см. раздел «Модели»).

## Запуск GUI
```bash
python run.py
```

По умолчанию приложение читает настройки из `config.yaml`. Укажите свои пути к видеопотокам (локальные файлы или RTSP) и интервал отправки кадров для логирования.

## Конфигурация
- `config.yaml` — список видеопотоков и интервал отправки кадров.
- `configs/plate_patterns.yaml` — регулярные выражения для фильтрации распознанных номеров и присвоения регионов.

Пример `config.yaml`:
```yaml
plate_image_send_interval: 20
video_paths:
  - rtsp://user:password@host:port/path
```

## Структура проекта
- `run.py` — точка входа GUI.
- `gui/` — компоненты интерфейса.
- `process_video_realtime.py` — обработка видеопотока и вызовы модели.
- `recognition_plate.py` — подготовка изображений и распознавание текста.
- `utils/config.py` — загрузка и сохранение конфигурации.
- `configs/` — шаблоны номерных знаков.
- `train/` — скрипты и конфигурации для обучения модели.

## Модели
Файл `models/best.pt` должен содержать веса дообученной модели YOLO, рассчитанные на детекцию номерных знаков. Если путь или файл отсутствуют, приложение сообщит об ошибке при запуске обработки видео.

## Отладка
Для сохранения промежуточных изображений при распознавании используйте параметр `debug_dir` класса `PlateRecognizer` (см. `recognition_plate.py`).

## Тестирование
Минимальная проверка корректности импорта модулей:
```bash
python -m compileall .
```
Дополнительные тесты зависят от наличия моделей и видеопотоков.
